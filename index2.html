<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f0f4f8; margin:0; padding:20px; }
    .container { max-width:800px; margin:auto; background:#fff; border-radius:8px; padding:20px; box-shadow:0 3px 8px rgba(0,0,0,0.1); }
    h1 { color:#2563eb; text-align:center; }
    table { width:100%; border-collapse:collapse; margin-top:16px; }
    th, td { padding:10px; border:1px solid #ddd; text-align:left; font-size:14px; }
    th { background-color:#3b82f6; color:#fff; }
    tr:nth-child(even) { background-color:#f9f9f9; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1>
    <table id="tasksTable">
      <thead>
        <tr>
          <th>‡∏ß‡∏¥‡∏ä‡∏≤</th>
          <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
          <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á</th>
          <th>‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î</th>
          <th>‡∏ß‡∏±‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
        </tr>
      </thead>
      <tbody id="tasksBody">
        <tr><td colspan="5">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
      </tbody>
    </table>
  </div>

  <script>
    const GAS_WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbxUzQIc5LGAsmESzUKcE5SWatPslHwyWzFTvWD6s_GFF2h4t6MxtD5JmHjpJySsDBX3xg/exec'; // ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Web App ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà

    async function loadTasks() {
      try {
        const response = await fetch(GAS_WEBAPP_URL + '?action=getTasks');
        if (!response.ok) throw new Error('Network response was not ok');

        const data = await response.json();
        const tbody = document.getElementById('tasksBody');

        if (!data.length) {
          tbody.innerHTML = '<tr><td colspan="5">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
          return;
        }

        tbody.innerHTML = data.map(t => `
          <tr>
            <td>${t.subject}</td>
            <td>${t.description}</td>
            <td>${t.assignedDate}</td>
            <td>${t.dueDate}</td>
            <td>${t.leftDay} days</td>
          </tr>
        `).join('');
      } catch (error) {
        console.error('Error loading tasks:', error);
        document.getElementById('tasksBody').innerHTML = '<tr><td colspan="5">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</td></tr>';
      }
    }

    loadTasks();
  </script>
</body>
</html>
